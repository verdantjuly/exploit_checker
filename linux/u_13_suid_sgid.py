import utils.auth_checker

def check_suid_sgid():
    file_list = ["/sbin/dump","/sbin/restore","/sbin/unix_chkpwd","/usr/bin/at","/usr/bin/lpq", "/usr/bin/lpq-lpd", "/usr/bin/lpr", "/usr/bin/lpr-lpd", "/usr/bin/lprm", "/usr/bin/lprm-lpd", "/usr/bin/newgrp", "/usr/sbin/lpc", "/usr/sbin/lpc-lpd", "/usr/sbin/traceroute"]
    is_exploit = False
    for file in file_list:
        auth_line = utils.auth_checker.main(file).split(" ")[0]
        if "s" in list(auth_line):
            print(f"SUID, SGID 권한 설정 필요 파일 : {file}")
            is_exploit = True
    
    return is_exploit

def main():
    print("")
    print("======================= U-13 SUID, SGID, 설정 파일점검 =========================")
    if check_suid_sgid() == False:
        print("[양호] SUID, SGID, 설정 파일점검")
    else:
        print("[취약] SUID, SGID, 설정 파일점검")
        



