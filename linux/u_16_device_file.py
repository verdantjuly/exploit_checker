import subprocess

def check_device_file():
    device_files = subprocess.run("find /dev -type b -o -type c -exec sh -c '""ls -l \"$1\" | awk \"{print \\$5}\" | grep -q \"^0,0$\" && echo \"$1\"' _ {} \\;", shell=True, capture_output=True, text=True).stdout
    is_exploit = False
    if device_files:
        is_exploit = True
        for line in print(device_files).splitlines():
            print(line)
            
    return is_exploit

def main():
    print("")
    print("======================= U-16 /dev에 존재하지 않는 device 파일 점검 =========================")
    if check_device_file() == False:
        print("[양호] /dev에 존재하지 않는 device 파일 점검")
    else:
        print("[취약] /dev에 존재하지 않는 device 파일 점검")