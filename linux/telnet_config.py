import os

def search_config_file(file_path, search_pattern):
    if not os.path.isfile(file_path):
        print(f"       File not found: {file_path}")
        return False

    try:
        with open(file_path, 'r') as file:
            for line in file:
                if line.strip().startswith('#'):
                    continue
                if search_pattern in line:
                    return True
    except Exception as e:
        print(f"       Error reading file {file_path}: {e}")
    return False

def main():
 
    pam_file = '/etc/pam.d/login'
    securetty_file = '/etc/securetty'
    pam_pattern = 'auth required /lib/security/pam_securetty.so'
    securetty_pattern = 'pts'

  
    if search_config_file(pam_file, pam_pattern):
        print(f"[양호] root 계정 원격 접속 제한 : Linux configuration found in {pam_file}: {pam_pattern}")
    else:
        print(f"[취약] root 계정 원격 접속 제한 : Linux configuration not found in {pam_file}.")

   
    if search_config_file(securetty_file, securetty_pattern):
        print(f"[취약] root 계정 원격 접속 제한 (pts) : pts Linux configuration found in {securetty_file}: {securetty_pattern}")
    else:
        print(f"[양호] root 계정 원격 접속 제한 (pts) : pts Linux configuration not found in {securetty_file}.")


