
import utils.auth_counter
import utils.auth_checker

def check_ownership():
    result = utils.auth_checker.main("/etc/syslog.conf")
    if result == "":
        result = utils.auth_checker.main("/etc/rsyslog.conf")
        print("[N/A] /etc/syslog.conf 파일 소유자 및 권한 설정")
        return
    
    auth_num = utils.auth_counter.main(result.split(" ")[0])
    
    if auth_num <= 640 and result.split(" ")[2] == "root":
        print("[양호] /etc/syslog.conf 파일 소유자 및 권한 설정")
    else:
        print("[취약] /etc/syslog.conf 파일 소유자 및 권한 설정")


def main():
    print("")
    print("======================= U-11 /etc/syslog.conf 파일 소유자 및 권한 설정 =========================")
    check_ownership()