import subprocess

PASSWD_PATH = "/etc/passwd"

def is_shadow():
    try:
        result = subprocess.run('ls /etc', shell=True, capture_output=True, text=True)
        if "shadow" in result:
            passwd()
        else:
            print("[취약] 패스워드 파일 보호 ")

    except Exception as e:
        print(f"       스크립트 실행 중 오류 발생: {e}")


def passwd():
    try:
        with open(PASSWD_PATH, 'r') as file:
            for line in file:
                if line.split(":")[1][0] == "x":
                    print("[양호] 패스워드 파일 보호 ")
                else:
                    print("[취약] 패스워드 파일 보호 ")
    except FileNotFoundError:
        print(f"       파일이 존재하지 않습니다: {file_path}")
    except Exception as e:
        print(f"       파일을 읽는 중 오류 발생: {e}")

def main():
    print("")
    print("======================= U-04 패스워드 파일 보호 =======================")
    is_shadow()


