import subprocess

PASSWD_PATH = "/etc/passwd"


def is_shadow(total_result):
    try:
        result = subprocess.run('ls /etc', shell=True, capture_output=True, text=True)
        output = result.stdout

        if "shadow" in output:
            passwd(total_result)
        else:
            print("       shadow 파일 미존재")
            total_result = False

    except Exception as e:
        print(f"       스크립트 실행 중 오류 발생: {e}")


def passwd(total_result):
    try:
        with open(PASSWD_PATH, 'r') as file:
            for line in file:
                if line.split(":")[1][0] != "x":
                    print(f"       패스워드 파일 보호 필요 : {line}")
                    total_result = False
            if total_result == True:
                print("[양호] 패스워드 파일 보호 ")
            else:
                print("[취약] 패스워드 파일 보호 ")
                
                    
    except FileNotFoundError:
        print(f"       파일이 존재하지 않습니다: {file_path}")
    except Exception as e:
        print(f"       파일을 읽는 중 오류 발생: {e}")

def main():
    print("")
    print("======================= U-04 패스워드 파일 보호 =======================")
    total_result = True
    is_shadow(total_result)


