import os
import platform

def check_permit_root_login(config_file):
    try:
        with open(config_file, 'r') as file:
            for line in file:
                line = line.strip()
                if line and not line.startswith('#'):
                    if 'PermitRootLogin No' in line:
                        return True
        return False
    except FileNotFoundError:
        print(f"파일을 열 수 없습니다: {config_file}")
        return False

def main():
    os_type = platform.system()

    # OS에 따른 SSH 설정 파일 경로
    if os_type == "SunOS":
        ssh_config_file = "/etc/ssh/sshd_config"
    elif os_type == "Linux":
        ssh_config_file = "/etc/ssh/sshd_config"
    elif os_type == "AIX":
        ssh_config_file = "/etc/ssh/sshd_config"
    elif os_type == "HP-UX":
        ssh_config_file = "/etc/ssh/sshd_config"
    else:
        print(f"지원하지 않는 OS: {os_type}")
        return
    
    # PermitRootLogin No 항목 확인
    print(f"검사 중: {ssh_config_file}")
    if check_permit_root_login(ssh_config_file):
        print(f"[양호] root 계정 원격 접속 제한 : {os_type} :PermitRootLogin No 항목이 설정 파일에 있습니다.")
    else:
        print(f"[취약] root 계정 원격 접속 제한 : {os_type} :PermitRootLogin No 항목이 설정 파일에 없습니다.")


